webpackJsonp([2],{0:function(n,e,l){n.exports=l("cDNt")},1:function(n,e){},YuZA:function(n,e){function l(n){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+n+"'.")})}l.keys=function(){return[]},l.resolve=l,n.exports=l,l.id="YuZA"},cDNt:function(n,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=l("LMZF"),o=l("TMwh"),i=(l("GQSG"),function(){function n(n){this.http=n,this.config=null}return Object.defineProperty(n.prototype,"configData",{get:function(){return this.config},enumerable:!0,configurable:!0}),n.prototype.load=function(){var n=this;return new Promise(function(e,l){n.http.get("/chatbot/configuration").map(function(n){return n.json()}).subscribe(function(l){n.config=l,e(!0)})})},n}()),s=function(){},u=function(){this.title="cb"},r=l("Un6q"),a=function(){function n(){}return n.prototype.transform=function(n,e){return new Date(Date.parse(n||new Date)).toLocaleTimeString()},n}(),c=function(){function n(n){this.el=n,this.hideToggle=!0,this.isCollapsed=!0}return n.prototype.ngAfterViewInit=function(){var n=this;this.elementChange&&this.elementChange.innerHTML&&(this.text=this.elementChange.innerHTML,this.toggleView(),this.hideToggle?this.el.nativeElement.classList.add("hidden"):this.el.nativeElement.classList.remove("hidden"),this.el.nativeElement.addEventListener("click",function(e){e.preventDefault(),n.toggleView()}))},n.prototype.ngOnChanges=function(){this.text&&this.toggleView()},n.prototype.toggleView=function(){this.determineView(),this.isCollapsed=!this.isCollapsed,this.isCollapsed?(this.el.nativeElement.querySelector(".more").style.display="none",this.el.nativeElement.querySelector(".less").style.display="inherit"):(this.el.nativeElement.querySelector(".more").style.display="inherit",this.el.nativeElement.querySelector(".less").style.display="none")},n.prototype.determineView=function(){var n=document.getElementById(this.elementChange.id);if(this.text.length<=this.maxLength)return this.currentText=this.text,n.innerHTML=this.currentText,this.isCollapsed=!1,void(this.hideToggle=!0);this.hideToggle=!1,!0===this.isCollapsed?(this.currentText=this.text.substring(0,this.maxLength)+".",n.innerHTML=this.currentText):!1===this.isCollapsed&&(this.currentText=this.text,n.innerHTML=this.currentText)},n}(),h=function(){function n(){}return n.prototype.ngOnInit=function(){},n}(),g=t._1({encapsulation:0,styles:[[".read-more-link[_ngcontent-%COMP%]{cursor:pointer;color:#6495ed}"]],data:{}});function d(n){return t._26(0,[(n()(),t._3(0,0,null,null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null))],null,function(n,e){n(e,0,0,e.component.message.text)})}function p(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"span",[],null,null,null,null,null)),(n()(),t._3(1,0,null,null,0,"img",[["alt",""],["style","height: 195px; width: 193px"]],[[8,"src",4]],null,null,null,null))],null,function(n,e){n(e,1,0,e.component.message.text)})}function f(n){return t._26(0,[(n()(),t._3(0,0,null,null,2,"div",[["class","user_time"],["style","font-size: 0.6em;"]],null,null,null,null,null)),(n()(),t._24(1,null,["",""])),t._19(2,1)],null,function(n,e){var l=e.component;n(e,1,0,t._25(e,1,0,n(e,2,0,t._15(e.parent,0),l.message.timestamp)))})}function _(n){return t._26(0,[t._17(0,a,[]),(n()(),t._24(-1,null,["  "])),(n()(),t._3(2,0,null,null,36,"div",[["class","bubble-row"],["style","margin-right: 5px;"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t._3(4,0,null,null,30,"div",[["class","bubble"]],null,null,null,null,null)),t._2(5,278528,null,0,r.h,[t.q,t.r,t.k,t.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t._18(6,{"bot-says toggle-wrap":0,"user-says":1}),(n()(),t._24(-1,null,["\n      \t"])),(n()(),t._3(8,0,null,null,25,"div",[["class","entry-content"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(10,0,null,null,22,"div",[["class","content111"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n     "])),(n()(),t._3(12,0,[["textContent",1]],null,3,"p",[],[[8,"id",0]],null,null,null,null)),(n()(),t._24(-1,null,[" "])),(n()(),t.Y(16777216,null,null,1,null,d)),t._2(15,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n      "])),(n()(),t.Y(16777216,null,null,1,null,p)),t._2(18,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n      "])),(n()(),t._3(20,0,null,null,11,"div",[["class","read-more-link"]],[[8,"hidden",0]],null,null,null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t._3(22,0,null,null,8,"a",[["readMore",""]],null,null,null,null,null)),t._2(23,4734976,null,0,c,[t.k],{maxLength:[0,"maxLength"],elementChange:[1,"elementChange"]},null),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(25,0,null,null,1,"span",[["class","less"]],null,null,null,null,null)),(n()(),t._24(-1,null,["Read Less "])),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(28,0,null,null,1,"span",[["class","more"]],null,null,null,null,null)),(n()(),t._24(-1,null,["Read More "])),(n()(),t._24(-1,null,["\n        "])),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n    "])),(n()(),t._24(-1,null,["\n    "])),(n()(),t.Y(16777216,null,null,1,null,f)),t._2(37,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n  "])),(n()(),t._24(-1,null,["\n"]))],function(n,e){var l=e.component;n(e,5,0,"bubble",n(e,6,0,"bot"===l.message.sentBy||"bot_child"===l.message.sentBy||"agent"===l.message.sentBy||"agent_child"===l.message.sentBy,"user"===l.message.sentBy)),n(e,15,0,l.message.text&&"data"!=l.message.text.split(":")[0]),n(e,18,0,l.message.text&&"data"==l.message.text.split(":")[0]),n(e,23,0,300,t._15(e,12)),n(e,37,0,"user"===l.message.sentBy)},function(n,e){var l=e.component;n(e,12,0,"read-more"+l.i),n(e,20,0,"user"===l.message.sentBy||l.message.text.length<280)})}var v=l("x47I"),m=l("HU86"),y=l("0nO6"),b=function(){this.chatBot={welcome:function(){return"/welcome"},message:function(){return"/message"},reset:function(){return"/reset"}},this.types={TEXT:"text",QR:"quick_reply",LOCATION:"location",QRT:"text",PB:"postback",WEB_URL:"web_url",IMG:"image",AGENT_REDIRECT:"agent_redirect"},this.webwidget_types={TEXT:"webwidget_text",QR:"webwidget_quick_reply",LOCATION:"webwidget_location",QRT:"webwidget_text",PB:"webwidget_postback",WEB_URL:"webwidget_web_url",IMG:"webwidget_image"}},w=l("UHIZ"),k=(l("Ykf1"),l("AP4T")),S=l("MjLF"),x=this&&this.__assign||Object.assign||function(n){for(var e,l=1,t=arguments.length;l<t;l++)for(var o in e=arguments[l])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},I=function(){function n(n){this.configService=n}return n.prototype.initSocket=function(){console.log("socket init",S),this.socket=S(this.configService.configData.widgetServer,x({},this.configService.configData.SocketOptions,{query:{botsession:""}})),this.registerEvents()},n.prototype.send=function(n){this.socket.emit("message",n)},n.prototype.welcome=function(n){this.socket.emit("welcome",n)},n.prototype.connect=function(){this.socket.connect()},n.prototype.open=function(n){this.socket.io.opts.query=n?{botsession:n}:"",this.socket.open()},n.prototype.close=function(){this.socket.close()},n.prototype.onMessage=function(){var n=this;return new k.a(function(e){n.socket.on("message",function(n){return e.next(n)})})},n.prototype.onEvent=function(n){var e=this;return new k.a(function(l){e.socket.on(n,function(){return l.next()})})},n.prototype.registerEvents=function(){var n=this;this.socket.on("reconnect_attempt",function(e){n.socket.io.opts.transports=["polling","websocket"]}),this.socket.on("connecting",function(e){console.log("Connecting",S),console.log("Connecting Socket",n.socket),console.log("Connecting Io",n.socket.io),console.log("Connecting Handshake",n.socket.io.handshake),console.log("Connecting Handshake2",n.socket.handshake),console.log("Connecting request",n.socket.request),console.log("Connecting response",n.socket.response)})},n}(),M=function(){function n(){}return n.prototype.setItem=function(n,e){window.localStorage?localStorage.setItem(n,e):console.log("local storage not supported")},n.prototype.getItem=function(n){var e;return window.localStorage?e=localStorage.getItem(n):console.log("local storage not supported"),e||""},n.prototype.removeItem=function(n){window.localStorage?localStorage.removeItem(n):console.log("local storage not supported")},n.prototype.clear=function(){window.localStorage?localStorage.clear():console.log("local storage not supported")},n}(),T=function(){function n(n,e,l){this.configService=n,this.cookieService=e,this.storageService=l}return n.prototype.set=function(n,e,l){this.cookieService.set(n,e,l),this.storageService.setItem(n,e)},n.prototype.get=function(n){return this.cookieService.get(n)||this.storageService.getItem(n)||null},n.prototype.remove=function(n){this.cookieService.delete(n),this.storageService.removeItem(n)},Object.defineProperty(n.prototype,"repositoryName",{get:function(){return this.cookieService.check("convoId")?"cookie":"localstorage"},enumerable:!0,configurable:!0}),n.prototype.check=function(n){var e=!1;return this.cookieService.check(n)?e=!0:(this.checkExpiryTime(),this.storageService.getItem(n)&&(e=!0)),e},n.prototype.checkExpiryTime=function(){var n=this.configService.configData.tokenExpiry,e=(new Date).getTime(),l=this.storageService.getItem("expiryTime");l&&e-l>60*n*60*1e3&&(this.storageService.removeItem("convoId"),this.storageService.removeItem("session"))},n}(),C=this&&this.__awaiter||function(n,e,l,t){return new(l||(l=Promise))(function(o,i){function s(n){try{r(t.next(n))}catch(n){i(n)}}function u(n){try{r(t.throw(n))}catch(n){i(n)}}function r(n){n.done?o(n.value):new l(function(e){e(n.value)}).then(s,u)}r((t=t.apply(n,e||[])).next())})},E=this&&this.__generator||function(n,e){var l,t,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(l)throw new TypeError("Generator is already executing.");for(;s;)try{if(l=1,t&&(o=t[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,t=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(n,s)}catch(n){i=[6,n],t=0}finally{l=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},L=function(){function n(n,e,l,t,o,i,s){var u=this;this.socketService=n,this.cookieService=e,this.storageService=l,this.storageHelper=t,this.http=o,this._Activatedroute=i,this.configService=s,this.options={};var r=new b;this.BotUrl=r.chatBot,this._Activatedroute.queryParams.subscribe(function(n){u.baseUrl=n.name})}return n.handleError=function(n){return Promise.reject(n.message||n)},n.prototype.getCookieExpiryTime=function(n){void 0===n&&(n=15);var e=new Date,l=new Date(e);return l.setHours(e.getHours()+n),l},n.prototype.converse=function(n,e){return C(this,void 0,void 0,function(){var e;return E(this,function(l){return e={},n&&(e.connectorPayload=n),this.sendMessage(e),[2]})})},n.prototype.visual_search=function(e){return C(this,void 0,void 0,function(){var l;return E(this,function(t){switch(t.label){case 0:return l=this.configService.configData.visual_search,this.options.withCredentials=!0,[4,this.http.post(l,e,this.options).toPromise().then(function(n){return n.json()}).catch(n.handleError)];case 1:return[2,t.sent()]}})})},n.prototype.getLocation=function(n){window.navigator.geolocation?window.navigator.geolocation.getCurrentPosition(function(e){e?n(null,{latitude:e.coords.latitude,longitude:e.coords.longitude}):n("ERROR",null)},function(e){n(e,null)}):n("ERROR",null)},n.prototype.sendMessage=function(n){return C(this,void 0,void 0,function(){var e,l,t;return E(this,function(o){switch(o.label){case 0:return console.log("chat service inside - send message "),this.storageHelper.check("convoId")?(this.getConvoId=this.storageHelper.get("convoId"),[3,5]):[3,1];case 1:return console.log("chat service inside - send message - token not found ",this.cookieService.check("convoId")),[4,this.resetToken()];case 2:return o.sent(),console.log("chat service inside - send message - token set",this.getSessionId()),[4,this.initiateSession()];case 3:return o.sent(),console.log("chat service inside - send message - session initiated"),e=this.getCookieExpiryTime(this.configService.configData.tokenExpiry),this.storageHelper.set("session","true",e),l=this.configService.configData.guestCredential.username,[4,this.socketService.welcome({conversationId:this.getSessionId(),botName:this.getBotName(),username:l})];case 4:o.sent(),console.log("chat service inside - send message - welcome done"),o.label=5;case 5:return console.log("chat service inside - send message - paylaod"),console.log({payload:n,convoId:this.getSessionId(),botName:this.baseUrl}),t=this.storageHelper.get("convoId"),this.socketService.send({payload:n,convoId:t,botName:this.baseUrl}),[2]}})})},n.prototype.login=function(e){return C(this,void 0,void 0,function(){return E(this,function(l){switch(l.label){case 0:return console.log("Inside login"),[4,this.http.post(this.configService.configData.login,e).toPromise().then(function(n){return n.json()}).catch(n.handleError)];case 1:return[2,l.sent()]}})})},n.prototype.userPreferences=function(e){return C(this,void 0,void 0,function(){var l;return E(this,function(t){switch(t.label){case 0:return l=new o.d({Authorization:"Bearer "+this.getSessionId()}),[4,this.http.put(this.configService.configData.preferences,e,{headers:l}).toPromise().then(function(n){return n.json()}).catch(n.handleError)];case 1:return[2,t.sent()]}})})},n.prototype.addJsessionId=function(e,l){return C(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,this.http.post(this.configService.configData.addJsessionId+e,l).toPromise().then(function(n){return n.json()}).catch(n.handleError)];case 1:return[2,t.sent()]}})})},n.prototype.getBotName=function(){return this.baseUrl||"Not Found"},n.prototype.getSessionId=function(){return this.storageHelper.get("convoId")},n.prototype.readChat=function(e,l){return C(this,void 0,void 0,function(){var t;return E(this,function(i){switch(i.label){case 0:return t=new o.d({Authorization:"Bearer "+this.getSessionId()}),[4,this.http.put(this.configService.configData.history+l,e,{headers:t}).toPromise().then(function(n){return n.json()}).catch(n.handleError)];case 1:return[2,i.sent()]}})})},n.prototype.initiateSession=function(){return C(this,void 0,void 0,function(){var n,e;return E(this,function(l){switch(l.label){case 0:return console.log("chat service inside - Initiating session"),e=this.configService.configData.session,this.storageHelper.check("convoId")?[3,2]:[4,this.resetToken()];case 1:l.sent(),l.label=2;case 2:return n=this.storageHelper.get("convoId"),console.log("chat service inside - Initiating session - token set",n),[4,this.http.post(e,{token:n}).toPromise()];case 3:return[2,l.sent()]}})})},n.prototype.postMessageToParent=function(n){window.parent.postMessage({name:n.subject,value:n.value},this.configService.configData.parentOrigin)},n.prototype.validate=function(n){return C(this,void 0,void 0,function(){return E(this,function(n){return[2,!0]})})},n.prototype.resetToken=function(){return C(this,void 0,void 0,function(){var n,e;return E(this,function(l){switch(l.label){case 0:return console.log("Chat service inside - reset token"),[4,this.login(this.configService.configData.guestCredential)];case 1:return n=l.sent().token,console.log("Chat service inside - got the token",n),e=this.getCookieExpiryTime(this.configService.configData.tokenExpiry),this.storageHelper.set("convoId",n,e),this.storageService.setItem("expiryTime",this.currentTime()),console.log("Chat service inside - set the token in cookie",n),this.postMessageToParent({subject:"setCookie",value:"convoId="+this.storageHelper.get("convoId")}),[2]}})})},n.prototype.stickySessionDummyCall=function(){return this.http.get(this.configService.configData.widgetServer+this.configService.configData.widgetServerEndpoint,{withCredentials:!0}).toPromise()},n.prototype.getStickSessionCookies=function(){return C(this,void 0,void 0,function(){var n;return E(this,function(e){switch(e.label){case 0:return[4,this.stickySessionDummyCall()];case 1:if(n=e.sent(),console.log("STATUS: "+n.statusCode),console.log("HEADERS: ",n.headers.get("X-Botsession")),this.botsession=n.headers.get("X-Botsession"),!this.botsession)throw new Error("Bot session is empty");return this.storageHelper.set("botsession",this.botsession,null),[2]}})})},n.prototype.openConnection=function(){this.storageHelper.check("convoId")?this.socketService.open(this.storageHelper.get("convoId")):console.error("No conversation id found for socket connection")},n.prototype.currentTime=function(){return(new Date).getTime()},n}(),P=this&&this.__awaiter||function(n,e,l,t){return new(l||(l=Promise))(function(o,i){function s(n){try{r(t.next(n))}catch(n){i(n)}}function u(n){try{r(t.throw(n))}catch(n){i(n)}}function r(n){n.done?o(n.value):new l(function(e){e(n.value)}).then(s,u)}r((t=t.apply(n,e||[])).next())})},B=this&&this.__generator||function(n,e){var l,t,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(l)throw new TypeError("Generator is already executing.");for(;s;)try{if(l=1,t&&(o=t[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,t=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(n,s)}catch(n){i=[6,n],t=0}finally{l=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},H=function(){function n(n){this.chat=n,this.credential={username:"",password:""},this.successMessage=new t.m,this.errorMessage=new t.m,this.error=""}return n.prototype.ngOnInit=function(){},n.prototype.userLogin=function(){return P(this,void 0,void 0,function(){var n,e;return B(this,function(l){switch(l.label){case 0:if(!this.credential.username||!this.credential.password)return this.handleError("please enter your username and password"),[2];l.label=1;case 1:return l.trys.push([1,3,,4]),this.error="",[4,this.chat.userPreferences({username:this.credential.username,password:this.credential.password})];case 2:return n=l.sent(),this.successMessage.emit(n),[3,4];case 3:return e=l.sent(),this.errorMessage.emit(e),this.error="Error occurred during the operation. Please try again",[3,4];case 4:return[2]}})})},n.prototype.handleError=function(n){if(n._body){var e=JSON.parse(n._body);this.error=e.message||e}else this.error=n.message||n},n}(),j=t._1({encapsulation:0,styles:[[""]],data:{}});function O(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"div",[["class","form-error-message"]],null,null,null,null,null)),(n()(),t._24(1,null,["",""]))],null,function(n,e){n(e,1,0,e.component.error)})}function R(n){return t._26(0,[(n()(),t._24(-1,null,["  "])),(n()(),t._3(1,0,null,null,26,"div",[["class","bubble-row"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t._3(3,0,null,null,23,"div",[["class","bubble bot-says"],["style","margin-top: 10px"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n      Login to your Account:\n      "])),(n()(),t._3(5,0,null,null,6,"div",[["class","form-field"]],null,null,null,null,null)),(n()(),t._3(6,0,null,null,5,"input",[["name","UserName"],["placeholder","Enter User Name"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var o=!0,i=n.component;return"input"===e&&(o=!1!==t._15(n,7)._handleInput(l.target.value)&&o),"blur"===e&&(o=!1!==t._15(n,7).onTouched()&&o),"compositionstart"===e&&(o=!1!==t._15(n,7)._compositionStart()&&o),"compositionend"===e&&(o=!1!==t._15(n,7)._compositionEnd(l.target.value)&&o),"ngModelChange"===e&&(o=!1!==(i.credential.username=l)&&o),o},null,null)),t._2(7,16384,null,0,y.b,[t.B,t.k,[2,y.a]],null,null),t._20(1024,null,y.e,function(n){return[n]},[y.b]),t._2(9,671744,null,0,y.h,[[8,null],[8,null],[8,null],[2,y.e]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),t._20(2048,null,y.f,null,[y.h]),t._2(11,16384,null,0,y.g,[y.f],null,null),(n()(),t._24(-1,null,["\n      "])),(n()(),t._3(13,0,null,null,6,"div",[["class","form-field"]],null,null,null,null,null)),(n()(),t._3(14,0,null,null,5,"input",[["name","Password"],["placeholder","Enter Password"],["type","password"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var o=!0,i=n.component;return"input"===e&&(o=!1!==t._15(n,15)._handleInput(l.target.value)&&o),"blur"===e&&(o=!1!==t._15(n,15).onTouched()&&o),"compositionstart"===e&&(o=!1!==t._15(n,15)._compositionStart()&&o),"compositionend"===e&&(o=!1!==t._15(n,15)._compositionEnd(l.target.value)&&o),"ngModelChange"===e&&(o=!1!==(i.credential.password=l)&&o),o},null,null)),t._2(15,16384,null,0,y.b,[t.B,t.k,[2,y.a]],null,null),t._20(1024,null,y.e,function(n){return[n]},[y.b]),t._2(17,671744,null,0,y.h,[[8,null],[8,null],[8,null],[2,y.e]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),t._20(2048,null,y.f,null,[y.h]),t._2(19,16384,null,0,y.g,[y.f],null,null),(n()(),t._24(-1,null,["\n      "])),(n()(),t._3(21,0,null,null,1,"a",[["class","external-link"],["href","javascript:void (0)"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.userLogin()&&t),t},null,null)),(n()(),t._24(-1,null,[" Login"])),(n()(),t._24(-1,null,["\n      "])),(n()(),t.Y(16777216,null,null,1,null,O)),t._2(25,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n    "])),(n()(),t._24(-1,null,["\n"])),(n()(),t._24(-1,null,["\n"]))],function(n,e){var l=e.component;n(e,9,0,"UserName",l.credential.username),n(e,17,0,"Password",l.credential.password),n(e,25,0,l.error)},function(n,e){n(e,6,0,t._15(e,11).ngClassUntouched,t._15(e,11).ngClassTouched,t._15(e,11).ngClassPristine,t._15(e,11).ngClassDirty,t._15(e,11).ngClassValid,t._15(e,11).ngClassInvalid,t._15(e,11).ngClassPending),n(e,14,0,t._15(e,19).ngClassUntouched,t._15(e,19).ngClassTouched,t._15(e,19).ngClassPristine,t._15(e,19).ngClassDirty,t._15(e,19).ngClassValid,t._15(e,19).ngClassInvalid,t._15(e,19).ngClassPending)})}var A=function(){function n(n){this.zone=n}return n.prototype.record=function(){var n=this;return k.a.create(function(e){var l=window.webkitSpeechRecognition;n.speechRecognition=new l,n.speechRecognition.continuous=!0,n.speechRecognition.lang="en-us",n.speechRecognition.maxAlternatives=1,n.speechRecognition.onstart=function(){e.next({permission:!0})},n.speechRecognition.onend=function(){},n.speechRecognition.onresult=function(l){var t="";if(l.results){var o=l.results[l.resultIndex];o.isFinal&&(o[0].confidence<.3||(t=o[0].transcript.trim(),console.log("Did you said? -> "+t+" , If not then say something else...")))}n.zone.run(function(){e.next(t)})},n.speechRecognition.onerror=function(n){e.error(n)},n.speechRecognition.onend=function(){e.complete()},n.speechRecognition.start()})},n.prototype.DestroySpeechObject=function(){this.speechRecognition&&this.speechRecognition.stop()},n}(),D=function(n,e,l){this.type=n,this.payload=e,this.channel=l},V=(l("OBUk"),l("f0Jb"),l("S4Bb")),N=function(){return function(n){var e=this;this.configService=n,this.container_height=function(){V(window).height();var n=V(window).width(),l=e.configService.configData.widgetHeight,t=V(window).height()-40;n>668?V("#modal-container").css("height",l):V("#modal-container").css("height",t),V("#modal-container").css("min-height","250px")},this.scroll_height=function(){e.container_height();var n=V(".wrapper").height(),l=(V(".scrollbar").height(),V(".error-message").height()),t=V(".action-sections").height(),o=n-t,i=n-(l+t+10);V(".error-message").is(":visible")?V(".scrollbar").css("height",i):V(".scrollbar").css("height",o)}}}(),U=this&&this.__assign||Object.assign||function(n){for(var e,l=1,t=arguments.length;l<t;l++)for(var o in e=arguments[l])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},q=this&&this.__awaiter||function(n,e,l,t){return new(l||(l=Promise))(function(o,i){function s(n){try{r(t.next(n))}catch(n){i(n)}}function u(n){try{r(t.throw(n))}catch(n){i(n)}}function r(n){n.done?o(n.value):new l(function(e){e(n.value)}).then(s,u)}r((t=t.apply(n,e||[])).next())})},J=this&&this.__generator||function(n,e){var l,t,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(l)throw new TypeError("Generator is already executing.");for(;s;)try{if(l=1,t&&(o=t[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,t=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(n,s)}catch(n){i=[6,n],t=0}finally{l=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Y=function(){function n(n,e,l,o,i,s,u,r,a,c){var h=this;this.socketService=n,this.cookieService=e,this.storageService=l,this.storageHelper=o,this.chat=i,this._Activatedroute=s,this.speechRecognitionService=u,this.configService=r,this.widgetHeight=a,this.zone=c,this.messages=[],this.loading=!1,this.formValue="",this.hideme={},this.channel="WebWidget",this.errorMessage=!1,this.tryAgain=!1,this.placeHolder="Type your message here",this.initiateSession=new t.m,this.displayWelcome=new t.m,this.activateSpeechSearchMovie=function(){h.speechRecognitionService.record().subscribe(function(n){n.permission?h.zone.run(function(){h.voiceRecording=!0}):(h.formValue=n,h.sendMessage(null,h.types.TEXT,null,null),h.zone.run(function(){h.voiceRecording=!1}))},function(n){h.zone.run(function(){h.voiceRecording=!1}),console.log("speech error",n)},function(){h.zone.run(function(){h.voiceRecording=!1})})},window.addEventListener("message",this.handleMessageFromParentWindow.bind(this),!1),console.log("Inside chat dialogue - contructor"),this.types=(new b).types,this.webwidget_types=(new b).webwidget_types,this.hideme={},this._Activatedroute.queryParams.subscribe(function(n){h.botName=n.name}),this.voiceRecording=!1,this.getStartedText="Start chat"}return n.prototype.ngOnInit=function(){var n=this;console.log("Inside chat dialogue"),this.storageHelper.check("convoId")?this.storageHelper.check("session")&&(console.log("Inside chat dialogue - convo and session exist"),this.messages=[],this.sessionIntiated=!0,this.chat.openConnection()):this.displayWelcome.emit(),0!==this.messages.length||this.storageHelper.check("session")||this.messages.push({type:"text",text:'Please click below "Start chat" button to start conversation.',sentBy:"bot",read:!0,id:"firstMessage"}),this.socketService.onEvent("connect").subscribe(function(){console.log("connected"),n.tryAgain=!1,n.errorMessage=!1;var e=n.configService.configData.guestCredential.username;n.getConvoId=n.storageHelper.get("convoId"),console.log("Inside chat dialogue - socket connect event"),console.log("paylaod",{conversationId:n.getConvoId,botName:n.botName,username:e}),n.socketService.welcome({conversationId:n.getConvoId,botName:n.botName,username:e}),n.widgetHeight.scroll_height()}),this.socketService.onEvent("connecting").subscribe(function(){n.widgetHeight.scroll_height(),n.errorMessage="connecting...",n.sessionIntiated=!0,n.tryAgain=!1}),this.socketService.onEvent("disconnect").subscribe(function(){}),this.socketService.onEvent("connect_failed").subscribe(function(){}),this.socketService.onEvent("error").subscribe(function(){}),this.socketService.onEvent("reconnect_failed").subscribe(function(){n.loading=!1,n.placeHolder="Type your message here",n.errorMessage="",n.getStartedText="Start chat",n.sessionIntiated=!1}),this.socketService.onEvent("reconnect").subscribe(function(){n.errorMessage=!1}),this.socketService.onEvent("reconnecting").subscribe(function(){n.errorMessage="reconnecting...",n.widgetHeight.scroll_height()}),this.socketService.onEvent("agent/chat/finished").subscribe(function(){console.log("AGENT STATUS UPDATED"),n.chat.postMessageToParent({subject:"setCookie",value:"live-agent=false"})}),this.socketService.onMessage().subscribe(function(e){clearTimeout(n.timeOut),n.loading=!1,n.placeHolder="Type your message here",Array.isArray(e)?(n.handleMultipleMessages(e),setTimeout(n.animatedScroll)):(n.messages.push(U({},e.data,{sentBy:e.sentBy,timestamp:e.timestamp})),setTimeout(n.animatedScroll));for(var l=n.messages.length-2;l>0;l--)n.hideme[l]=!0})},n.prototype.ngOnChanges=function(n){n.sessionIntiated&&!0===n.sessionIntiated.currentValue&&(this.loading=!0,this.placeHolder="Please wait...")},n.prototype.connectSocketAgain=function(){this.chat.openConnection()},n.prototype.sendMessage=function(n,e,l,t){this.loading||(this.formValue=this.formValue.trim(),(this.formValue||l)&&this.messages.push({text:this.formValue||l,type:"text",sentBy:"user"}),setTimeout(this.animatedScroll),this.formValue||(this.hideme[t]=!this.hideme[t]),(n||this.formValue)&&(this.loading=!0,this.placeHolder="Please wait..."),e===this.types.TEXT&&this.formValue?this.chat.converse(new D(this.webwidget_types.TEXT,{text:this.formValue},this.channel),[this.formValue]):e===this.types.QR?this.chat.converse(new D(this.webwidget_types.QR,n,this.channel),[l]):e===this.types.LOCATION?this.userCurrentLocation(l):e===this.types.QRT?this.chat.converse(new D(this.webwidget_types.QRT,n,this.channel),[l]):e===this.types.PB?this.chat.converse(new D(this.webwidget_types.PB,U({},n,{title:l}),this.channel),[l]):e===this.types.WEB_URL?(this.loading=!1,this.placeHolder="Type your message here",window.open(n)):e===this.types.AGENT_REDIRECT?this.agentFn():console.log("Type not found"),this.formValue="",this.speechRecognitionService.DestroySpeechObject(),this.hideTypingLogo())},n.prototype.sendCarouselMessage=function(n){var e=n.value,l=n.type,t=n.title,o=n.i;l!==this.types.WEB_URL&&this.messages.push({text:this.formValue||t,type:"text",sentBy:"user"}),setTimeout(this.animatedScroll),this.hideme[o]=!this.hideme[o],e&&(this.loading=!0,this.placeHolder="Please wait..."),l===this.types.QR?this.chat.converse(new D(this.webwidget_types.QR,e,this.channel),[t]):l===this.types.LOCATION?this.userCurrentLocation(t):l===this.types.QRT?this.chat.converse(new D(this.webwidget_types.QRT,e,this.channel),[t]):l===this.types.PB?this.chat.converse(new D(this.webwidget_types.PB,U({},e,{title:t}),this.channel),[t]):l===this.types.WEB_URL&&(this.loading=!1,this.placeHolder="Type your message here",window.open(e)),this.formValue="",this.speechRecognitionService.DestroySpeechObject(),this.hideTypingLogo()},n.prototype.sendMenu=function(n,e,l){this.messages.push({text:l,type:"text",sentBy:"user"}),setTimeout(this.animatedScroll),this.loading=!0,this.placeHolder="Please wait...",this.chat.converse(new D(this.webwidget_types.TEXT,{text:n},this.channel),[l]),this.hideTypingLogo()},n.prototype.userCurrentLocation=function(n){var e=this;this.chat.getLocation(function(l,t){e.chat.converse(new D(e.webwidget_types.QR,l?l.code?{location:!1,error:l.code}:{location:!0,coordinates:{latitude:"41.8051098",longitude:"-88.1463026"}}:{location:!0,coordinates:{latitude:t.latitude,longitude:t.longitude}},e.channel),[n])})},n.prototype.changeListener=function(n){return q(this,void 0,void 0,function(){var e,l,t,o,i=this;return J(this,function(s){switch(s.label){case 0:e=n.target.files[0],(l=new FileReader).readAsDataURL(e),l.onloadend=function(){i.messages.push({text:l.result,type:"text",sentBy:"user"}),i.chat.converse(null,[l.result]),i.imageData.nativeElement.value=""},(t=new FormData).append("image",e,e.name),s.label=1;case 1:return s.trys.push([1,4,,5]),this.loading=!0,this.placeHolder="Please wait...",[4,this.chat.visual_search(t)];case 2:return(o=s.sent()).visual_search=!0,[4,this.chat.converse(new D(this.webwidget_types.IMG,o,this.channel),!1)];case 3:return s.sent(),[3,5];case 4:return s.sent(),this.loading=!1,this.placeHolder="Type your message here",[3,5];case 5:return[2]}})})},n.prototype.ngOnDestroy=function(){this.speechRecognitionService.DestroySpeechObject(),clearTimeout(this.timeOut)},n.prototype.scrollToBottom=function(){V("div#aiAgentScrol").scrollTop(V("div#aiAgentScrol")[0].scrollHeight-10)},n.prototype.animatedScroll=function(){V("div#aiAgentScrol").animate({scrollTop:V("div#aiAgentScrol")[0].scrollHeight-10},400)},n.prototype.loginSuccess=function(n){this.loading=!0,this.placeHolder="Please wait...",this.chat.converse(new D(this.webwidget_types.PB,{initiateAuthentication:!0},this.channel),!1)},n.prototype.loginError=function(n){this.loading=!1},n.prototype.hideTypingLogo=function(){var n=this;this.timeOut=setTimeout(function(){n.loading=!1,n.placeHolder="Type your message here"},2e4)},n.prototype.agentFn=function(){var n=this;this.loading=!0,this.placeHolder="Please wait...",this.messages&&this.messages.length>0&&"newTabAgent"!==this.messages[this.messages.length-1].id&&(this.chat.converse(new D(this.webwidget_types.QR,this.messages.length>this.configService.configData.noOfWelcomeMsg?{type:"text",title:"",message:"jivoaftermessage"}:{type:"text",title:"",message:"jivodirect"},this.channel),!1),this.chat.converse(new D(this.webwidget_types.QR,{type:"text",title:"Talk to an associate",message:"jivocommon"},this.channel),!1)),setTimeout(function(){n.chat.postMessageToParent({subject:"goToliveAgent",value:"true"})},300)},n.prototype.startSession=function(){this.initiateSession.emit(),this.getStartedText="Connecting..."},n.prototype.handleMultipleMessages=function(n){var e=this;n.forEach(function(n){e.messages.push(U({},n.data,{sentBy:n.sentBy,timestamp:n.timestamp}))})},n.prototype.handleMessageFromParentWindow=function(n){console.log("Event Received",n),""!==n.data&&(console.log("EVENT passed",n.origin),n.data&&("liveAgentCurrentState"===n.data.name?(this.loading=!1,this.placeHolder="Type your message here",console.log(n.data.botMessage),this.messages.push({type:"text",text:n.data.botMessage,sentBy:"bot",read:!0,id:"newTabAgent"}),setTimeout(this.animatedScroll)):console.log("Unknown event")))},n}(),W=l("ceki"),$=t._1({encapsulation:0,styles:[["a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:hover{text-decoration:none}.dropdown-item.active[_ngcontent-%COMP%], .dropdown-item[_ngcontent-%COMP%]:active{background-color:#d65b8d;color:#fff}a.external-link[_ngcontent-%COMP%]{color:#fff;border:1px solid #3f51b5;background-color:#2196f3;border-radius:6px;font-weight:700}a.external-link[_ngcontent-%COMP%]:hover{color:#6f8794;border:1px solid #6f8794;background-color:#fff\n  }.gray_color[_ngcontent-%COMP%]{color:gray!important}[_ngcontent-%COMP%]::-webkit-input-placeholder{ color:gray;opacity:1 }[_ngcontent-%COMP%]::-ms-input-placeholder{ color:gray;opacity:1 }[_ngcontent-%COMP%]::placeholder{ color:gray;opacity:1 }"]],data:{}});function F(n){return t._26(0,[(n()(),t._3(0,0,null,null,4,"span",[["style","color: #1c3b71; cursor: pointer"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.connectSocketAgain()&&t),t},null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t._3(2,0,null,null,1,"b",[],null,null,null,null,null)),(n()(),t._24(-1,null,["Try again"])),(n()(),t._24(-1,null,["\n      "]))],null,null)}function Q(n){return t._26(0,[(n()(),t._3(0,0,null,null,4,"div",[["class","error-message"]],null,null,null,null,null)),(n()(),t._24(1,null,["\n      ","\n      "])),(n()(),t.Y(16777216,null,null,1,null,F)),t._2(3,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n    "]))],function(n,e){n(e,3,0,e.component.tryAgain)},function(n,e){n(e,1,0,e.component.errorMessage)})}function z(n){return t._26(0,[(n()(),t._3(0,0,null,null,0,"div",[["class","icon icon-logo avatar"]],null,null,null,null,null))],null,null)}function Z(n){return t._26(0,[(n()(),t._3(0,0,null,null,0,"div",[["class","icon icon-agent-logo-4 avatar"]],null,null,null,null,null))],null,null)}function G(n){return t._26(0,[(n()(),t._3(0,0,null,null,6,"div",[],null,null,null,null,null)),t._2(1,278528,null,0,r.h,[t.q,t.r,t.k,t.B],{ngClass:[0,"ngClass"]},null),t._18(2,{"user-says-inner":0}),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(4,0,null,null,1,"cb-text",[],null,null,null,_,g)),t._2(5,114688,null,0,h,[],{message:[0,"message"],i:[1,"i"]},null),(n()(),t._24(-1,null,["\n          "]))],function(n,e){n(e,1,0,n(e,2,0,"user"===e.parent.context.$implicit.sentBy)),n(e,5,0,e.parent.context.$implicit,e.parent.context.index)},null)}function X(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"a",[["class","quick-reply"],["href","javascript:void(0)"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.sendMessage(n.parent.context.$implicit.payload,"quick_reply",n.parent.context.$implicit.title,n.parent.parent.parent.context.index)&&t),t},null,null)),(n()(),t._24(1,null,[""," "]))],null,function(n,e){n(e,1,0,e.parent.context.$implicit.title)})}function K(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"a",[["class","quick-reply"],["target","_blank"]],[[8,"href",4]],null,null,null,null)),(n()(),t._24(1,null,[""," "]))],null,function(n,e){n(e,0,0,t._6(1,"",e.parent.parent.context.$implicit.payload,"")),n(e,1,0,e.parent.parent.context.$implicit.title)})}function nn(n){return t._26(0,[(n()(),t._24(-1,null,["\n                  "])),(n()(),t.Y(16777216,null,null,1,null,K)),t._2(2,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),t._24(-1,null,["\n                "]))],function(n,e){n(e,2,0,"web_url"===e.parent.context.$implicit.content_type,t._15(e.parent,8))},null)}function en(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"a",[["class","quick-reply"],["href","javascript:void(0)"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.sendMessage({},"agent_redirect",n.parent.parent.context.$implicit.title,n.parent.parent.parent.parent.context.index)&&t),t},null,null)),(n()(),t._24(1,null,[""," "]))],null,function(n,e){n(e,1,0,e.parent.parent.context.$implicit.title)})}function ln(n){return t._26(0,[(n()(),t._24(-1,null,["\n                  "])),(n()(),t.Y(16777216,null,null,1,null,en)),t._2(2,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n                "]))],function(n,e){n(e,2,0,"agent_redirect"===e.parent.context.$implicit.content_type)},null)}function tn(n){return t._26(0,[(n()(),t._3(0,0,null,null,9,"app-quick-reply-item",[["style","cursor: pointer"]],[[8,"hidden",0]],null,null,v.d,v.b)),t._2(1,114688,null,0,m.f,[],null,null),(n()(),t._24(-1,0,["\n                "])),(n()(),t.Y(16777216,null,0,1,null,X)),t._2(4,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),t._24(-1,0,["\n                "])),(n()(),t.Y(0,[["webUrlQuickReply",2]],0,0,null,nn)),(n()(),t._24(-1,0,["\n                "])),(n()(),t.Y(0,[["agentRedirectQuickReply",2]],0,0,null,ln)),(n()(),t._24(-1,0,["\n              "]))],function(n,e){n(e,1,0),n(e,4,0,"text"===e.context.$implicit.content_type,t._15(e,6))},function(n,e){n(e,0,0,e.component.hideme[e.parent.parent.context.index])})}function on(n){return t._26(0,[(n()(),t._3(0,0,null,null,11,"div",[],null,null,null,null,null)),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(2,0,null,null,1,"cb-text",[],null,null,null,_,g)),t._2(3,114688,null,0,h,[],{message:[0,"message"],i:[1,"i"]},null),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(5,0,null,null,5,"app-quick-reply",[],null,null,null,v.c,v.a)),t._2(6,114688,null,0,m.e,[],null,null),(n()(),t._24(-1,0,["\n              "])),(n()(),t.Y(16777216,null,0,1,null,tn)),t._2(9,802816,null,0,r.i,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),(n()(),t._24(-1,0,["\n            "])),(n()(),t._24(-1,null,["\n          "]))],function(n,e){n(e,3,0,e.parent.context.$implicit,e.parent.context.index),n(e,6,0),n(e,9,0,e.parent.context.$implicit.options)},null)}function sn(n){return t._26(0,[(n()(),t._3(0,0,null,null,7,"div",[],[[8,"hidden",0]],null,null,null,null)),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(2,0,null,null,1,"cb-text",[],null,null,null,_,g)),t._2(3,114688,null,0,h,[],{message:[0,"message"],i:[1,"i"]},null),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(5,0,null,null,1,"cb-login-from",[],null,[[null,"successMessage"],[null,"errorMessage"]],function(n,e,l){var t=!0,o=n.component;return"successMessage"===e&&(t=!1!==o.loginSuccess(l)&&t),"errorMessage"===e&&(t=!1!==o.loginError(l)&&t),t},R,j)),t._2(6,114688,null,0,H,[L],null,{successMessage:"successMessage",errorMessage:"errorMessage"}),(n()(),t._24(-1,null,["\n          "]))],function(n,e){n(e,3,0,e.parent.context.$implicit,e.parent.context.index),n(e,6,0)},function(n,e){n(e,0,0,e.component.hideme[e.parent.context.index])})}function un(n){return t._26(0,[(n()(),t._3(0,0,null,null,5,"div",[["class","bubble-row"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(2,0,null,null,2,"div",[["class","bot_time"],["style","font-size: 0.6em;"]],null,null,null,null,null)),(n()(),t._24(3,null,["",""])),t._19(4,1),(n()(),t._24(-1,null,["\n          "]))],null,function(n,e){n(e,3,0,t._25(e,3,0,n(e,4,0,t._15(e.parent.parent,0),e.parent.context.$implicit.timestamp)))})}function rn(n){return t._26(0,[(n()(),t._3(0,0,null,null,23,"div",[["class","b-wrap"]],null,null,null,null,null)),t._2(1,278528,null,0,r.h,[t.q,t.r,t.k,t.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t._18(2,{"user-says-wrapper":0}),(n()(),t._24(-1,null,["\n          "])),(n()(),t.Y(16777216,null,null,1,null,z)),t._2(5,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n          "])),(n()(),t.Y(16777216,null,null,1,null,Z)),t._2(8,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n          "])),(n()(),t._24(-1,null,["\n          "])),(n()(),t._24(-1,null,["\n\n          "])),(n()(),t.Y(16777216,null,null,1,null,G)),t._2(13,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n\n          "])),(n()(),t.Y(16777216,null,null,1,null,on)),t._2(16,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n\n          "])),(n()(),t.Y(16777216,null,null,1,null,sn)),t._2(19,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n\n          "])),(n()(),t.Y(16777216,null,null,1,null,un)),t._2(22,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n\n        "]))],function(n,e){n(e,1,0,"b-wrap",n(e,2,0,"user"===e.context.$implicit.sentBy)),n(e,5,0,"bot"===e.context.$implicit.sentBy),n(e,8,0,"agent"===e.context.$implicit.sentBy),n(e,13,0,"text"===e.context.$implicit.type&&e.context.$implicit.text),n(e,16,0,"options"===e.context.$implicit.type),n(e,19,0,"form"===e.context.$implicit.type),n(e,22,0,"user"!==e.context.$implicit.sentBy)},null)}function an(n){return t._26(0,[(n()(),t._3(0,0,null,null,7,"div",[["class","typing-indicator"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(2,0,null,null,0,"span",[],null,null,null,null,null)),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(4,0,null,null,0,"span",[],null,null,null,null,null)),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(6,0,null,null,0,"span",[],null,null,null,null,null)),(n()(),t._24(-1,null,["\n        "]))],null,null)}function cn(n){return t._26(0,[(n()(),t._3(0,0,null,null,3,"button",[["class","pull-right"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.activateSpeechSearchMovie()&&t),t},null,null)),(n()(),t._24(-1,null,["\n                "])),(n()(),t._3(2,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-microphone fa-lg gray_color"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n              "]))],null,null)}function hn(n){return t._26(0,[(n()(),t._3(0,0,null,null,32,"button",[["class","pull-right"],["id",""]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                "])),(n()(),t._24(-1,null,["\n                "])),(n()(),t._3(3,0,null,null,28,"div",[["class","voice_chat_animation"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                  "])),(n()(),t._3(5,0,null,null,25,"div",[["class","voice_recording"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                    "])),(n()(),t._3(7,0,null,null,22,":svg:svg",[["data-name","Layer 1"],["id","wave"],["viewBox","0 0 50 38.05"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(9,0,null,null,1,":svg:title",[],null,null,null,null,null)),(n()(),t._24(-1,null,["Audio Wave"])),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(12,0,null,null,0,":svg:path",[["d","M0.91,15L0.78,15A1,1,0,0,0,0,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H0.91Z"],["data-name","Line 1"],["id","Line_1"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(14,0,null,null,0,":svg:path",[["d","M6.91,9L6.78,9A1,1,0,0,0,6,10V28a1,1,0,1,0,2,0s0,0,0,0V10A1,1,0,0,0,7,9H6.91Z"],["data-name","Line 2"],["id","Line_2"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(16,0,null,null,0,":svg:path",[["d","M12.91,0L12.78,0A1,1,0,0,0,12,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H12.91Z"],["data-name","Line 3"],["id","Line_3"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(18,0,null,null,0,":svg:path",[["d","M18.91,10l-0.12,0A1,1,0,0,0,18,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H18.91Z"],["data-name","Line 4"],["id","Line_4"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(20,0,null,null,0,":svg:path",[["d","M24.91,15l-0.12,0A1,1,0,0,0,24,16v6a1,1,0,0,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H24.91Z"],["data-name","Line 5"],["id","Line_5"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(22,0,null,null,0,":svg:path",[["d","M30.91,10l-0.12,0A1,1,0,0,0,30,11V27a1,1,0,1,0,2,0s0,0,0,0V11a1,1,0,0,0-1-1H30.91Z"],["data-name","Line 6"],["id","Line_6"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(24,0,null,null,0,":svg:path",[["d","M36.91,0L36.78,0A1,1,0,0,0,36,1V37a1,1,0,1,0,2,0s0,0,0,0V1a1,1,0,0,0-1-1H36.91Z"],["data-name","Line 7"],["id","Line_7"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(26,0,null,null,0,":svg:path",[["d","M42.91,9L42.78,9A1,1,0,0,0,42,10V28a1,1,0,1,0,2,0s0,0,0,0V10a1,1,0,0,0-1-1H42.91Z"],["data-name","Line 8"],["id","Line_8"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                      "])),(n()(),t._3(28,0,null,null,0,":svg:path",[["d","M48.91,15l-0.12,0A1,1,0,0,0,48,16v6a1,1,0,1,0,2,0s0,0,0,0V16a1,1,0,0,0-1-1H48.91Z"],["data-name","Line 9"],["id","Line_9"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n                    "])),(n()(),t._24(-1,null,["\n                  "])),(n()(),t._24(-1,null,["\n                "])),(n()(),t._24(-1,null,["\n              "]))],null,null)}function gn(n){return t._26(0,[(n()(),t._3(0,0,null,null,36,"div",[],null,null,null,null,null)),(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(2,0,null,null,33,"div",[["class","message"]],null,null,null,null,null)),t._2(3,278528,null,0,r.h,[t.q,t.r,t.k,t.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t._18(4,{"disable-div":0,"show-div":1}),(n()(),t._24(-1,null,["\n              "])),(n()(),t._3(6,0,null,null,3,"button",[["class",""]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.sendMenu("menu","text","Menu")&&t),t},null,null)),(n()(),t._24(-1,null,["\n                "])),(n()(),t._3(8,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-bars fa-lg gray_color"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n              "])),(n()(),t._3(11,0,null,null,5,"input",[["type","text"]],[[8,"placeholder",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"keyup.enter"],[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,e,l){var o=!0,i=n.component;return"input"===e&&(o=!1!==t._15(n,12)._handleInput(l.target.value)&&o),"blur"===e&&(o=!1!==t._15(n,12).onTouched()&&o),"compositionstart"===e&&(o=!1!==t._15(n,12)._compositionStart()&&o),"compositionend"===e&&(o=!1!==t._15(n,12)._compositionEnd(l.target.value)&&o),"keyup.enter"===e&&(o=!1!==i.sendMessage(null,"text",null,null)&&o),"ngModelChange"===e&&(o=!1!==(i.formValue=l)&&o),o},null,null)),t._2(12,16384,null,0,y.b,[t.B,t.k,[2,y.a]],null,null),t._20(1024,null,y.e,function(n){return[n]},[y.b]),t._2(14,671744,null,0,y.h,[[8,null],[8,null],[8,null],[2,y.e]],{model:[0,"model"]},{update:"ngModelChange"}),t._20(2048,null,y.f,null,[y.h]),t._2(16,16384,null,0,y.g,[y.f],null,null),(n()(),t._24(-1,null,["\n              "])),(n()(),t.Y(16777216,null,null,1,null,cn)),t._2(19,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n              "])),(n()(),t._24(-1,null,["\n\n              "])),(n()(),t.Y(16777216,null,null,1,null,hn)),t._2(28,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n              "])),(n()(),t._3(30,0,null,null,4,"button",[["class","camera pull-right"],["id","button-actions"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.agentFn()&&t),t},null,null)),(n()(),t._24(-1,null,["\n                "])),(n()(),t._24(-1,null,["\n                "])),(n()(),t._3(33,0,null,null,0,"div",[["class","icon icon-agent-qa gray_color"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n\n              "])),(n()(),t._24(-1,null,["\n            "])),(n()(),t._24(-1,null,["\n          "]))],function(n,e){var l=e.component;n(e,3,0,"message",n(e,4,0,l.errorMessage||l.loading,!l.errorMessage)),n(e,14,0,l.formValue),n(e,19,0,!l.voiceRecording),n(e,28,0,l.voiceRecording)},function(n,e){n(e,11,0,t._6(1,"",e.component.placeHolder,""),t._15(e,16).ngClassUntouched,t._15(e,16).ngClassTouched,t._15(e,16).ngClassPristine,t._15(e,16).ngClassDirty,t._15(e,16).ngClassValid,t._15(e,16).ngClassInvalid,t._15(e,16).ngClassPending)})}function dn(n){return t._26(0,[(n()(),t._24(-1,null,["\n            "])),(n()(),t._3(1,0,null,null,4,"div",[["class","message center"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n              "])),(n()(),t._3(3,0,null,null,1,"a",[["class","external-link center_ext_button"],["href","JavaScript:void(0);"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.startSession()&&t),t},null,null)),(n()(),t._24(4,null,["",""])),(n()(),t._24(-1,null,["\n            "])),(n()(),t._24(-1,null,["\n          "]))],null,function(n,e){n(e,4,0,e.component.getStartedText)})}function pn(n){return t._26(0,[t._17(0,a,[]),t._22(402653184,1,{imageData:0}),(n()(),t._3(2,0,null,null,6,"div",[["id","modal-header"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(4,0,null,null,1,"div",[["id","title"]],null,null,null,null,null)),(n()(),t._24(-1,null,["Buyee's Bot Assistant"])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(7,0,null,null,0,"div",[["class","myModelClose"],["id","modal-close"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n"])),(n()(),t._24(-1,null,["\n"])),(n()(),t._3(10,0,null,null,37,"div",[["id","modal-content"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(12,0,null,null,34,"div",[["class","wrapper d-flex flex-column align-self-stretch justify-content-center"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t.Y(16777216,null,null,1,null,Q)),t._2(15,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n    "])),(n()(),t._3(17,0,null,null,28,"div",[["class","content"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n      "])),(n()(),t._3(19,0,null,null,7,"div",[["class","message-content scrollbar"],["id","aiAgentScrol"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t.Y(16777216,null,null,1,null,rn)),t._2(22,802816,null,0,r.i,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),(n()(),t._24(-1,null,["\n        "])),(n()(),t.Y(16777216,null,null,1,null,an)),t._2(25,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n\n      "])),(n()(),t._3(28,0,null,null,16,"div",[["class","action-sections"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t._3(30,0,null,null,13,"div",[["class","message-holder action-flds"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n          "])),(n()(),t.Y(16777216,null,null,1,null,gn)),t._2(33,16384,null,0,r.j,[t.M,t.J],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),t._24(-1,null,["\n\n          "])),(n()(),t._24(-1,null,["\n          "])),(n()(),t.Y(0,[["welcomeScreen",2]],null,0,null,dn)),(n()(),t._24(-1,null,["\n\n          "])),(n()(),t._3(38,0,null,null,4,"div",[["class","powered-by"]],null,null,null,null,null)),(n()(),t._24(-1,null,["Powered by\n            "])),(n()(),t._3(40,0,null,null,1,"a",[["href","https://www.aiagentbot.com/"],["target","_blank"]],null,null,null,null,null)),(n()(),t._24(-1,null,["AIagentbot.com"])),(n()(),t._24(-1,null,["\n          "])),(n()(),t._24(-1,null,["\n        "])),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n    "])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._24(-1,null,["\n"])),(n()(),t._24(-1,null,["\n"]))],function(n,e){var l=e.component;n(e,15,0,l.errorMessage),n(e,22,0,l.messages),n(e,25,0,l.loading),n(e,33,0,l.sessionIntiated,t._15(e,36))},null)}var fn=t.Z("cb-chat-dialog",Y,function(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"cb-chat-dialog",[],null,null,null,pn,$)),t._2(1,770048,null,0,Y,[I,W.a,M,T,L,w.a,A,i,N,t.x],null,null)],function(n,e){n(e,1,0)},null)},{sessionIntiated:"sessionIntiated"},{initiateSession:"initiateSession",displayWelcome:"displayWelcome"},[]),_n=this&&this.__assign||Object.assign||function(n){for(var e,l=1,t=arguments.length;l<t;l++)for(var o in e=arguments[l])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},vn=this&&this.__awaiter||function(n,e,l,t){return new(l||(l=Promise))(function(o,i){function s(n){try{r(t.next(n))}catch(n){i(n)}}function u(n){try{r(t.throw(n))}catch(n){i(n)}}function r(n){n.done?o(n.value):new l(function(e){e(n.value)}).then(s,u)}r((t=t.apply(n,e||[])).next())})},mn=this&&this.__generator||function(n,e){var l,t,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(l)throw new TypeError("Generator is already executing.");for(;s;)try{if(l=1,t&&(o=t[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,t=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(n,s)}catch(n){i=[6,n],t=0}finally{l=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},yn=function(){function n(n,e,l,t,o,i,s){var u=this;this.cookieService=n,this.socketService=e,this.storageService=l,this.storageHelper=t,this.chat=o,this.configService=i,this.widgetHeight=s,this.isAgentbotLauncherIsUp=!1,this.sessionIntiated=!1,this.lastMessageFromBot="",this.count=0,this.messages=[],this.socketService.initSocket(),this.socketService.onMessage().subscribe(function(n){Array.isArray(n)?u.handleMultipleMessages(n):u.messages.push(_n({},n.data,{sentBy:n.sentBy,read:n.read||!1,id:n.id}));var e=u.messages[u.messages.length-1];u.isAgentbotLauncherIsUp&&u.readChat(),e&&("bot"===e.sentBy||"agent"===e.sentBy)&&e.text&&e.text&&""!==e.text&&(u.lastMessageFromBot=e.text,!e||"bot"!==e.sentBy&&"bot_child"!==e.sentBy&&"agent"!==e.sentBy&&"agent_child"!==e.sentBy||e.read||!1!==u.isAgentbotLauncherIsUp||(V("#aiagentbadge").removeClass("dn"),V("#aiagentnotification").removeClass("dn"),u.count=u.count+1,u.chat.postMessageToParent({subject:"setNotification",value:!0})))})}return n.prototype.ngOnInit=function(){var n=this;console.log("Inside Widget"),this.storageHelper.check("convoId")?this.checkExpiry():this.guestLogin(),V("#aiagentbotLauncher").click(function(){setTimeout(n.scrollToBottom,200);var e=!1;V(".agentbotLauncher").fadeToggle("slow"),V(".chatprompt").hide("fast"),n.widgetHeight.scroll_height(),!0===V(".agentbotLauncher").is(":visible")?(e=!0,V("#aiagentbadge").addClass("dn"),V("#aiagentnotification").addClass("dn"),V(".chatprompt").addClass("aiagentbot-launcher-open"),n.readChat()):(e=!1,V(".chatprompt").removeClass("aiagentbot-launcher-open")),n.isAgentbotLauncherIsUp=!!e,e&&(n.count=0),n.chat.postMessageToParent({subject:"setVisiblity",value:e})}),V(".myModelClose").click(function(){V(".agentbotLauncher").fadeToggle("fast"),V(".chatprompt").show("slow"),n.isAgentbotLauncherIsUp=!1,n.chat.postMessageToParent({subject:"setVisiblity",value:!1})})},n.prototype.closeNotificaionBox=function(n){V("#aiagentnotification").addClass("dn"),this.chat.postMessageToParent({subject:"setVisiblity",value:!1}),n.stopPropagation()},n.prototype.scrollToBottom=function(){V("div#aiAgentScrol").scrollTop(V("div#aiAgentScrol")[0].scrollHeight)},n.prototype.guestLogin=function(){return vn(this,void 0,void 0,function(){var n,e,l;return mn(this,function(t){switch(t.label){case 0:console.log("Inside guest login"),navigator.cookieEnabled?console.log("cookie is enabled"):console.log("The browser does not support or is blocking cookies from being set"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.chat.login(this.configService.configData.guestCredential)];case 2:return n=t.sent().token,console.log("Inside guest login - TOKEN SET",n),e=this.chat.getCookieExpiryTime(this.configService.configData.tokenExpiry),this.storageHelper.set("convoId",n,e),this.storageService.setItem("expiryTime",this.chat.currentTime()),console.log("Inside guest login - TOKEN SET in LOCAL STORAGE",this.storageService.getItem("convoId")),console.log("Inside guest login - TOKEN SET in COOKIE",this.cookieService.get("convoId")),console.log("Inside guest login - checking token",n),console.log("Inside guest login - cookie service",this.cookieService),this.chat.postMessageToParent({subject:"setCookie",value:"convoId="+n}),this.showWelcomeMessage(),[3,4];case 3:return l=t.sent(),console.error("error while guest login",l),[3,4];case 4:return[2]}})})},n.prototype.readChat=function(){return vn(this,void 0,void 0,function(){var n,e,l,t,o;return mn(this,function(i){switch(i.label){case 0:if(n=this.messages.filter(function(n){return"user"!==n.sentBy&&!1===n.read}),this.messages=this.messages.filter(function(n){return!1===n.read}).map(function(n){return n.read=!0}),e=this.configService.configData.guestCredential.username,!n.length)return[2];i.label=1;case 1:i.trys.push([1,6,,7]),l=0,t=n,i.label=2;case 2:return l<t.length?[4,this.chat.readChat({id:t[l].id,read:!0},e)]:[3,5];case 3:i.sent(),i.label=4;case 4:return l++,[3,2];case 5:return[3,7];case 6:return o=i.sent(),console.error("error while updating chat",o),[3,7];case 7:return[2]}})})},n.prototype.onResize=function(n){this.widgetHeight.scroll_height()},n.prototype.startSession=function(){var n=this;console.log("Initiating session"),this.chat.initiateSession().then(function(e){if(console.log("Session Initiated"),n.storageHelper.check("convoId")){n.sessionIntiated=!0;var l=n.chat.getCookieExpiryTime(n.configService.configData.tokenExpiry);n.storageHelper.set("session","true",l),n.chat.openConnection()}}).catch(function(n){console.error("Session intiation failed")})},n.prototype.showWelcomeMessage=function(){this.count=1,this.lastMessageFromBot="Hi, this is Buyee's assistant, I am here to help you out \ud83d\ude0a",V("#aiagentbadge").removeClass("dn"),V("#aiagentnotification").removeClass("dn"),this.chat.postMessageToParent({subject:"setNotification",value:!0})},n.prototype.openWidget=function(){V("#aiagentbotLauncher").click()},n.prototype.checkExpiry=function(){return vn(this,void 0,void 0,function(){var n,e;return mn(this,function(l){switch(l.label){case 0:console.log("Inside widget - check expiry"),n=this.storageHelper.get("convoId"),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.chat.validate({token:n})];case 2:return l.sent(),this.chat.postMessageToParent({subject:"setCookie",value:"convoId="+n}),[3,4];case 3:return(e=l.sent())._body&&(JSON.parse(e._body),this.storageHelper.remove("convoId"),this.storageHelper.remove("session"),this.guestLogin()),console.error("error while validate login",e),[3,4];case 4:return[2]}})})},n.prototype.handleMultipleMessages=function(n){var e=this;n.forEach(function(n){e.messages.push(_n({},n.data,{sentBy:n.sentBy,read:n.read||!1,id:n.id}))})},n}(),bn=t._1({encapsulation:0,styles:[["@keyframes blink{0%{background-color:red}50%{background-color:rgba(255,0,0,.5)}to{background-color:red}}@-webkit-keyframes blink{0%{background-color:red}50%{background-color:rgba(255,0,0,.5)}to{background-color:red}}.circle[_ngcontent-%COMP%]{border-radius:30px;-webkit-transition:all .5s ease-in-out;transition:all .5s ease-in-out;\n  -webkit-animation:blink normal 1.5s infinite ease-in-out;\n  \n  animation:blink normal 1.5s infinite ease-in-out\n  }"]],data:{}});function wn(n){return t._26(0,[(n()(),t._3(0,0,null,null,32,"div",[["class","chatprompt"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(2,0,null,null,5,"div",[["class","aiagentbot-launch-icon"],["id","aiagentbotLauncher"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t._24(-1,null,["\n    "])),(n()(),t._3(5,0,null,null,0,"div",[["class","icon icon-logo"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(9,0,null,null,1,"i",[["class","chtbt-notification-badge dn"],["id","aiagentbadge"]],null,null,null,null,null)),(n()(),t._24(10,null,["",""])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(12,0,null,null,19,"div",[["class","chtbt-notifications-block dn"],["id","aiagentnotification"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t._3(14,0,null,null,16,"div",[["class","chtbt-notifications-wrapper"]],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.openWidget()&&t),t},null,null)),(n()(),t._24(-1,null,["\n      "])),(n()(),t._3(16,0,null,null,8,"div",[["class","chtbt-notification-closebtn"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t._3(18,0,null,null,5,":svg:svg",[],null,[[null,"click"]],function(n,e,l){var t=!0;return"click"===e&&(t=!1!==n.component.closeNotificaionBox(l)&&t),t},null,null)),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(20,0,null,null,0,":svg:path",[["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"],["data-reactid",".0.2.2.0.1.0.0"],["fill","currentColor"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n          "])),(n()(),t._3(22,0,null,null,0,":svg:path",[["d","M0 0h24v24H0z"],["data-reactid",".0.2.2.0.1.0.1"],["fill","none"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n      "])),(n()(),t._3(26,0,null,null,3,"div",[["class","chtbt-notification-text"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n        "])),(n()(),t._3(28,0,null,null,0,"span",[],[[8,"innerHTML",1]],null,null,null,null)),(n()(),t._24(-1,null,["\n      "])),(n()(),t._24(-1,null,["\n    "])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._24(-1,null,["\n"])),(n()(),t._24(-1,null,["\n"])),(n()(),t._3(34,0,null,null,9,"div",[["class","agentbotLauncher"],["id","modal-container"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(36,0,null,null,3,"div",[["id","modal-header"],["style","visibility: hidden;"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n    "])),(n()(),t._3(38,0,null,null,0,"div",[["id","modal-close"]],null,null,null,null,null)),(n()(),t._24(-1,null,["\n  "])),(n()(),t._24(-1,null,["\n  "])),(n()(),t._3(41,0,null,null,1,"cb-chat-dialog",[],null,[[null,"initiateSession"],[null,"displayWelcome"]],function(n,e,l){var t=!0,o=n.component;return"initiateSession"===e&&(t=!1!==o.startSession()&&t),"displayWelcome"===e&&(t=!1!==o.showWelcomeMessage()&&t),t},pn,$)),t._2(42,770048,null,0,Y,[I,W.a,M,T,L,w.a,A,i,N,t.x],{sessionIntiated:[0,"sessionIntiated"]},{initiateSession:"initiateSession",displayWelcome:"displayWelcome"}),(n()(),t._24(-1,null,["\n"]))],function(n,e){n(e,42,0,e.component.sessionIntiated)},function(n,e){var l=e.component;n(e,10,0,l.count),n(e,28,0,l.lastMessageFromBot)})}var kn=t.Z("cb-widget",yn,function(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"cb-widget",[],null,[["window","resize"]],function(n,e,l){var o=!0;return"window:resize"===e&&(o=!1!==t._15(n,1).onResize(l)&&o),o},wn,bn)),t._2(1,114688,null,0,yn,[W.a,I,M,T,L,i,N],null,null)],function(n,e){n(e,1,0)},null)},{},{},[]),Sn=t._1({encapsulation:0,styles:[[""]],data:{}});function xn(n){return t._26(0,[(n()(),t._3(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),t._2(1,212992,null,0,w.m,[w.b,t.M,t.j,[8,null],t.h],null,null),(n()(),t._24(-1,null,["\n"]))],function(n,e){n(e,1,0)},null)}var In=t.Z("cb-root",u,function(n){return t._26(0,[(n()(),t._3(0,0,null,null,1,"cb-root",[],null,null,null,xn,Sn)),t._2(1,49152,null,0,u,[],null,null)],null,null)},{},{},[]),Mn=l("RyBE"),Tn=l("S0PE"),Cn=l("MCDL"),En=l("fAeS"),Ln=function(){},Pn=(l("rgUS"),function(){}),Bn=function(){},Hn=t._0(s,[u],function(n){return t._11([t._12(512,t.j,t.W,[[8,[fn,kn,In]],[3,t.j],t.v]),t._12(5120,t.s,t._21,[[3,t.s]]),t._12(4608,r.l,r.k,[t.s,[2,r.p]]),t._12(5120,t.c,t._5,[]),t._12(5120,t.q,t._13,[]),t._12(5120,t.r,t._16,[]),t._12(4608,Mn.c,Mn.r,[r.c]),t._12(6144,t.E,null,[Mn.c]),t._12(4608,Mn.f,Mn.g,[]),t._12(5120,Mn.d,function(n,e,l,t,o){return[new Mn.k(n,e),new Mn.o(l),new Mn.n(t,o)]},[r.c,t.x,r.c,r.c,Mn.f]),t._12(4608,Mn.e,Mn.e,[Mn.d,t.x]),t._12(135680,Mn.m,Mn.m,[r.c]),t._12(4608,Mn.l,Mn.l,[Mn.e,Mn.m]),t._12(5120,Tn.a,Cn.d,[]),t._12(5120,Tn.c,Cn.e,[]),t._12(4608,Tn.b,Cn.c,[Tn.a,Tn.c]),t._12(5120,t.C,Cn.f,[Mn.l,Tn.b,t.x]),t._12(6144,Mn.p,null,[Mn.m]),t._12(4608,t.K,t.K,[t.x]),t._12(4608,Mn.h,Mn.h,[r.c]),t._12(4608,Mn.i,Mn.i,[r.c]),t._12(4608,y.k,y.k,[]),t._12(4608,y.c,y.c,[]),t._12(4608,En.b,Cn.b,[t.C,Mn.b]),t._12(4608,I,I,[i]),t._12(4608,W.a,W.a,[r.c]),t._12(4608,M,M,[]),t._12(4608,T,T,[i,W.a,M]),t._12(5120,w.a,w.v,[w.k]),t._12(4608,L,L,[I,W.a,M,T,o.e,w.a,i]),t._12(4608,A,A,[t.x]),t._12(4608,N,N,[i]),t._12(4608,w.e,w.e,[]),t._12(6144,w.f,null,[w.e]),t._12(135680,w.n,w.n,[w.k,t.u,t.i,t.p,w.f]),t._12(4608,w.d,w.d,[]),t._12(5120,w.h,w.y,[w.w]),t._12(5120,t.b,function(n){return[n]},[w.h]),t._12(512,r.b,r.b,[]),t._12(1024,t.l,Mn.q,[]),t._12(1024,t.w,function(){return[w.r()]},[]),t._12(512,w.w,w.w,[t.p]),t._12(512,o.c,o.c,[]),t._12(512,o.h,o.b,[]),t._12(1024,o.j,o.k,[]),t._12(512,o.i,o.i,[o.c,o.h,o.j]),t._12(512,o.g,o.a,[]),t._12(1024,o.e,o.l,[o.i,o.g]),t._12(512,i,i,[o.e]),t._12(1024,t.d,function(n,e,l){return[Mn.t(n),w.x(e),(t=l,function(){return t.load()})];var t},[[2,t.w],w.w,i]),t._12(512,t.e,t.e,[[2,t.d]]),t._12(131584,t.g,t.g,[t.x,t.X,t.p,t.l,t.j,t.e]),t._12(512,t.f,t.f,[t.g]),t._12(512,Mn.a,Mn.a,[[3,Mn.a]]),t._12(512,y.j,y.j,[]),t._12(512,y.d,y.d,[]),t._12(512,y.i,y.i,[]),t._12(1024,w.q,w.t,[[3,w.k]]),t._12(512,w.p,w.c,[]),t._12(512,w.b,w.b,[]),t._12(256,w.g,{preloadingStrategy:w.e},[]),t._12(1024,r.g,w.s,[r.n,[2,r.a],w.g]),t._12(512,r.f,r.f,[r.g]),t._12(512,t.i,t.i,[]),t._12(512,t.u,t.H,[t.i,[2,t.I]]),t._12(1024,w.i,function(){return[[{path:"chat",component:Y},{path:"widget",component:yn},{path:"**",component:Y}],[{path:"",redirectTo:"/chat",pathMatch:"full"}]]},[]),t._12(1024,w.k,w.u,[t.g,w.p,w.b,r.f,t.p,t.u,t.i,w.i,w.g,[2,w.o],[2,w.j]]),t._12(512,w.l,w.l,[[2,w.q],[2,w.k]]),t._12(512,Ln,Ln,[]),t._12(512,m.c,m.c,[]),t._12(512,m.b,m.b,[]),t._12(512,Cn.a,Cn.a,[]),t._12(512,Pn,Pn,[]),t._12(512,Bn,Bn,[]),t._12(512,o.f,o.f,[]),t._12(512,s,s,[])])});Object(t.Q)(),console.log=function(){return!1},Mn.j().bootstrapModuleFactory(Hn).catch(function(n){return console.log(n)})}},[0]);